/ required locals: activities
- paginated_objects ||= nil
.action_menu
  .action_menu_header
    .action_menu_header_left
      - if paginated_objects
        %p= page_entries_info paginated_objects, :entry_name=> 'activity'
        %p.paginator
          = will_paginate paginated_objects
    .action_menu_header_right
      %ul.menu
        / -if current_user.has_role? "author"
        %li= link_to "create new activity", new_activity_path

- for activity in activities
  %div{ :id => dom_id_for(activity), :class => 'runnable' }
    = accordion_for(activity, preview_button_for(activity) + link_to_container(activity, :hide_componenent_name => true), :activity) do  
      %div.action_menu
        %div.action_menu_header_left   
          = link_to_container(activity)
          %br
          %span.author
            = activity.user.name
          %span.details
            - pedigree_info_for(activity)
            %bt
            - descendant_info_for(activity)
        %div.action_menu_header_right   
          %ul.menu
            %li= preview_button_for(activity)
            - unless(current_user.anonymous?)
              %li.menu=link_to 'copy', duplicate_activity_url(activity)
            - if (activity.changeable?(current_user))
              %li.menu=link_to 'delete', activity, :class => 'delete', :confirm => "Are you sure you want to delete activity #{activity.id}", :method => :delete 
      %div{:id => dom_id_for(activity, :details), :class => 'tiny'}
        %p=activity.description
        %p
          %i= updated_time_text(activity)
        %p
          %i
            Used in: #{activity.offerings.length} classes.

  =draggable_element dom_id_for(activity), :revert => true , :scroll => 'window'

