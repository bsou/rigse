/ %h2 BEGIN: Custom code for ITSI-SU
/ required locals: is_being_edited
- if portal_clazz.is_teacher? current_user
  -# %form{ :id => 'activity_offers_form', :method=>"post", :action=>"/class/edit/#{portal_clazz.id}/process/"}
  = hidden_field_tag 'portal_clazz_id', portal_clazz.id
  %h2 
    Activities (total selected:
    %span#total-selected="#{portal_clazz.offerings.size}"
    )
  - bins = Activity.list_bins(portal_clazz)
  %table.activity-chart{ :border =>"0" :cellspacing=>"0" :cellpadding => "0" :width=> "100%"}
    %tr
      %td#activity-chart-navigation{:width => "225"}
        %ul
          - bins.each do |_tag|
            -#%li#middleschoolearthscience-control.unit-navigation.level1{:onclick => "show_section('#middleschoolearthscience', this);"}
            %li.bin_button{:class => _tag[:classes], :onclick => "show_section('#{_tag[:key]}', this);"}
              ="#{_tag[:name]} ("
              %span.tag_count
                =_tag[:off_count]
              ="/ #{_tag[:count]})"
      %td#activity-chart-panels
        - bins.each do |_tag|
          %div.show_section{:id => _tag[:key], :style=>"display: none;"}
            - units = _tag[:units]
            - units.each do |unit|
              %h2="#{unit[:name]} (#{unit[:count]})"
              - unit[:activities].each do |runnable|
                -#- Activity.published.each do |runnable|
                - offering = portal_clazz.offerings.detect { |o| o.runnable.id == runnable.id }
                - offering_id = offering.nil? ? false : offering.id
                = render :partial => 'portal/offerings/portal_edit', :locals => {:assigned => true, :offering_id => offering_id, :is_being_edited => true, :portal_clazz => portal_clazz, :runnable => runnable}
